CREATE TABLE pediatrics.basic_pays (
    employee_id INT,
    fiscal_year INT,
    salary DECIMAL(10, 2),
    PRIMARY KEY (employee_id, fiscal_year)
);

INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    100, 2017, 24000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    101, 2017, 17000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    102, 2017, 17000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    103, 2017, 9000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    104, 2017, 6000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    105, 2017, 4800
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    106, 2017, 4800
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    107, 2017, 4200
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    108, 2017, 12000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    109, 2017, 9000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    110, 2017, 8200
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    111, 2017, 7700
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    112, 2017, 7800
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    113, 2017, 6900
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    114, 2017, 11000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    115, 2017, 3100
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    116, 2017, 2900
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    117, 2017, 2800
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    118, 2017, 2600
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    119, 2017, 2500
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    120, 2017, 8000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    121, 2017, 8200
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    122, 2017, 7900
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    123, 2017, 6500
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    126, 2017, 2700
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    145, 2017, 14000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    146, 2017, 13500
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    176, 2017, 8600
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    177, 2017, 8400
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    178, 2017, 7000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    179, 2017, 6200
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    192, 2017, 4000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    193, 2017, 3900
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    200, 2017, 4400
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    201, 2017, 13000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    202, 2017, 6000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    203, 2017, 6500
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    204, 2017, 10000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    205, 2017, 12000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    206, 2017, 8300
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    100, 2018, 25920
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    101, 2018, 18190
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    102, 2018, 18360
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    103, 2018, 9720
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    104, 2018, 6060
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    105, 2018, 4992
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    106, 2018, 5040
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    107, 2018, 4284
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    108, 2018, 12360
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    109, 2018, 9540
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    110, 2018, 8692
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    111, 2018, 7931
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    112, 2018, 8580
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    113, 2018, 7107
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    114, 2018, 11440
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    115, 2018, 3131
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    116, 2018, 3161
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    117, 2018, 2940
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    118, 2018, 2652
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    119, 2018, 2650
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    120, 2018, 8800
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    121, 2018, 8364
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    122, 2018, 8611
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    123, 2018, 6565
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    126, 2018, 2808
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    145, 2018, 14560
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    146, 2018, 14580
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    176, 2018, 9202
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    177, 2018, 8988
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    178, 2018, 7630
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    179, 2018, 6448
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    192, 2018, 4320
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    193, 2018, 4173
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    200, 2018, 4620
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    201, 2018, 13000
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    202, 2018, 6360
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    203, 2018, 7085
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    204, 2018, 10100
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    205, 2018, 12360
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    206, 2018, 8632
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    100, 2020, 26179.2
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    101, 2020, 19463.3
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    102, 2020, 19278
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    103, 2020, 10206
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    104, 2020, 6605.4
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    105, 2020, 5391.36
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    106, 2020, 5191.2
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    107, 2020, 4498.2
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    108, 2020, 13472.4
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    109, 2020, 9826.2
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    110, 2020, 9561.2
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    111, 2020, 8248.24
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    112, 2020, 9352.2
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    113, 2020, 7107
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    114, 2020, 12012
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    115, 2020, 3224.93
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    116, 2020, 3287.44
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    117, 2020, 3175.2
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    118, 2020, 2864.16
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    119, 2020, 2782.5
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    120, 2020, 9152
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    121, 2020, 8531.28
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    122, 2020, 8697.11
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    123, 2020, 6630.65
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    126, 2020, 2920.32
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    145, 2020, 16016
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    146, 2020, 14871.6
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    176, 2020, 9938.16
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    177, 2020, 9167.76
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    178, 2020, 7858.9
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    179, 2020, 6641.44
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    192, 2020, 4406.4
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    193, 2020, 4339.92
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    200, 2020, 4712.4
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    201, 2020, 14040
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    202, 2020, 6614.4
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    203, 2020, 7155.85
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    204, 2020, 10908
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    205, 2020, 12730.8
);
INSERT INTO pediatrics.basic_pays (employee_id, fiscal_year, salary) VALUES (
    206, 2020, 8890.96
);

SELECT
    employee_id,
    fiscal_year,
    salary,
    lag(salary)
        OVER (
            PARTITION BY employee_id
            ORDER BY salary
        )
    AS previous_salary
FROM pediatrics.basic_pays;


SELECT
    employee_id,
    fiscal_year,
    salary,
    previous_salary,
    concat(
        round((salary - previous_salary) * 100 / previous_salary, 0), '%'
    ) AS yoy
FROM (
    SELECT
        employee_id,
        fiscal_year,
        salary,
        lag(salary, 1, null)
            OVER (
                PARTITION BY employee_id
                ORDER BY fiscal_year
            )
        AS previous_salary
    FROM pediatrics.basic_pays
);


SELECT
    employee_id,
    fiscal_year,
    salary,
    last_value(salary) OVER (
        PARTITION BY employee_id
        ORDER BY salary
        RANGE BETWEEN UNBOUNDED PRECEDING AND
        UNBOUNDED FOLLOWING
    )
FROM pediatrics.basic_pays;
